<div class="container">
    <div class="row">
        <div class="col-md-6 col-6">
            <button class="btn  btn-block {{#ifCond package 1 }}btn-danger{{else}} btn-outline-primary{{/ifCond}}"
                {{#ifCond package 1 }}disabled{{/ifCond}} id="singleAssetDetail" style="height:150px;"
                data-toggle="modal" data-target="#singleAssetDetail-Modal">查看資產詳情</button>
        </div>
        <div class="col-md-6 col-6">
            <button class="btn {{#ifCond package 0 }}btn-danger{{else}} btn-outline-primary{{/ifCond}} btn-block"
                {{#ifCond package 0 }}disabled{{/ifCond}} id="multipleAssetDetail" data-id="{{gatepassId}}"
                style="height:150px;" data-toggle="modal" data-target="#multipleAssetDetail-Modal">查看多個資產內容</button>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-md-6 col-6">
            <button class="btn {{#ifCond package 1 }}btn-danger{{else}} btn-outline-primary{{/ifCond}} btn-block"
                {{#ifCond package 1 }}disabled{{/ifCond}} id="singleAsset" style="height:150px;" data-toggle="modal"
                data-target="#singleAssetReceived-Modal">單個資產到貨</button>
        </div>
        <div class="col-md-6 col-6">
            <button class="btn {{#ifCond package 0 }}btn-danger{{else}} btn-outline-primary{{/ifCond}} btn-block"
                {{#ifCond package 0 }}disabled{{/ifCond}} id="multipleAsset" data-id="{{gatepassId}}" style="
                height:150px;">多個資產到貨</button>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-md-6 col-6">
            <button class="btn {{#ifCond package 1 }}btn-danger{{else}} btn-outline-primary{{/ifCond}} btn-block"
                {{#ifCond package 1 }}disabled{{/ifCond}} id="modifyAsset" style="height:150px;" data-toggle="modal"
                data-target="#modifyAsset-Modal">修改資產使用情況</button>
        </div>
        <div class="col-md-6 col-6">
            <button class="btn btn-danger btn-block" {{#ifCond package 1 }}disabled{{/ifCond}} id="checkAsset"
                style="height:150px;" disabled>資產盤點</button>
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-md-6 col-6">
            <button class="btn {{#ifCond package 1 }}btn-danger{{else}} btn-outline-primary{{/ifCond}} btn-block"
                id="singleAssetGatepass" style="height:150px;" data-toggle="modal"
                data-target="#singleAssetGatepass_Modal" disabled>單個資產移轉</button>
        </div>
        <div class="col-md-6 col-6">
            <button class="btn btn-outline-primary btn-block" id="scanqrcode_btn" style="height:150px;"
                data-toggle="modal" data-target="#scanqrcode_Modal">QR Code
                掃描到貨</button>
        </div>
    </div>


    {{!-- 單個資產修改 Modal --}}
    <div class="modal" tabindex="-1" role="dialog" id="modifyAsset-Modal">
        <div class="modal-dialog  modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">修改資產內容</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="modifyAsset-Modal-body">
                    <div class="row mb-3">
                        <div class="col-3"></div>
                        <div class="col-6">
                            <img src="" class="img-thumbnail img-fluid rounded mx-auto d-block" id="modifyAssetImage">
                        </div>
                        <div class="col-3"></div>
                    </div>
                    <form id="modifyAsset-Modal-body-form" action="/api/qrcode/asset/edit" method="post"
                        enctype="multipart/form-data">
                        {{!-- 這邊放要修改 qrcode 物品清單 --}}
                    </form>
                </div>
            </div>
        </div>
    </div>


    {{!-- 單個資產查詢 Modal --}}
    <div class=" modal" tabindex="-1" role="dialog" id="singleAssetDetail-Modal">
        <div class="modal-dialog  modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">當前資產內容</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="singleAssetDetail-Modal-body">
                    {{!-- 這邊放當前 qrcode 物品清單 --}}
                    <div class="row">
                        <div class="col-3"></div>
                        <div class="col-6">
                            <img src="" class="img-thumbnail img-fluid rounded mx-auto d-block" id="assetImage">
                        </div>
                        <div class="col-3"></div>
                    </div>
                    <div class="row mt-3">
                        <div class="font-weight-bold">資產編號: <span id="asset_id"></span></div>
                        <div class="font-weight-bold">類別: <span id="asset_category"></span></div>
                        <div class="font-weight-bold">名稱: <span id="asset_name"></span></div>
                        <div class="font-weight-bold">廠牌: <span id="asset_Vendor"></span></div>
                        <div class="font-weight-bold">型號: <span id="asset_Model"></span></div>
                        <div class="font-weight-bold">數量: <span id="asset_Quantity"></span></div>
                        <div class="font-weight-bold">狀態: <span id="asset_Status"></span></div>
                        <div class="font-weight-bold">位置: <span id="asset_Office"></span></div>
                        <div class="font-weight-bold">資產描述: <span id="asset_Description"></span></div>
                    </div>
                    <div class="row" id="singleAssetDetail-Modal-table-body">
                        {{!-- 這邊放單個資產渲染資料 --}}
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    {{!-- 單個資產移轉 Modal --}}
    <div class="modal fade" id="singleAssetGatepass_Modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">資產設備移轉</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="singleAssetGatepass_Modal_Body">
                    <div class='row'>
                        <div class='col-6' id='createGP_btn'>
                            <button class="btn btn-outline-primary btn-block" data-toggle="modal"
                                data-target="#singleAssetGatepass_Modal2">新建 Gatepass</button>
                        </div>


                        <div class='col-6' id='addGP_btn'>
                            <button class="btn btn-outline-primary btn-block" data-toggle="modal"
                                data-target="#scanqrcode_to_gatepass_Modal">加入 Gatepass</button>
                        </div>
                    </div>
                </div>
                <!--
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cencel</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
                -->
            </div>
        </div>
    </div>

    {{!-- QR Code 掃描入 gatepass Modal --}}
    <!-- Modal -->
    <div class="modal fade" id="scanqrcode_to_gatepass_Modal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">QR code 掃描加入 gatepass
                    </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row justify-content-center">
                        <div class="col">
                            <div>選擇 gatepass: <span id="scanqrcode_to_gatepass_message" class="text-danger"></span>
                            </div>
                            <select class="custom-select mt-3">
                                <option selected>Open this select menu</option>
                                <option value="1">One</option>
                                <option value="2">Two</option>
                                <option value="3">Three</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mt-2">
                        <div class="col border">

                            <video id="scanqrcode_to_gatepass_video" autoplay playsinline></video>


                        </div>
                    </div>
                    <div class="mt-2">待加入資產</div>
                    <div class="row ">

                        <div class="col-2">
                            #
                        </div>
                        <div class="col-3">
                            名稱
                        </div>
                        <div class="col-3">
                            編號
                        </div>
                        <div class="col-3">
                            圖片
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">加入 gatepass</button>
                </div>
            </div>
        </div>
    </div>


    {{!-- 創建 Gatepass Modal --}}
    <div class="modal fade" id="singleAssetGatepass_Modal2" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">新建 Gatepass </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="singleAssetGatepass_Modal_Body">

                    <div class='row'>
                        <div><label for="fromOffice">選擇起始位置</label></div>
                    </div>
                    <div class='row'>
                        <select class="custom-select" id='fromOffice'>

                        </select>
                    </div>
                    <div class='row mt-5'>
                        <div><label for="fromOffice">選擇目的位置</label></div>
                    </div>
                    <div class='row'>
                        <select class="custom-select" id='toOffice'>

                        </select>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"
                        id="returnSingleAssetGatepass">Return</button>
                    <button type="button" class="btn btn-primary" id="confirmGP_btn">成立 Gatepass</button>
                </div>
                <!--
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cencel</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
                -->
            </div>
        </div>
    </div>

    {{!-- 多個資產查詢 Modal --}}
    <div class="modal" tabindex="-1" role="dialog" id="multipleAssetDetail-Modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">當前 Gatepass 內容</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="multipleAssetDetail-Modal-body">
                    {{!-- 這邊放當前 gatepass 物品清單 --}}
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    {{!-- QR Code 掃描到貨 Modal --}}
    <!-- Modal -->
    <div class="modal fade" id="scanqrcode_Modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">QR code 掃描到貨
                    </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row justify-content-center">
                        <div class="col">
                            <div>到貨狀態: <span id="assetArrivedMessage" class="text-danger"></span></div>
                            <div class=" form-check form-switch">
                                <input class="form-check-input" type="checkbox" role="switch" id="openCameraSwitch"
                                    checked>
                                <label class="form-check-label" for="openCameraSwitch"
                                    id="openCameraSwitchLabel">關閉相機</label>
                            </div>
                        </div>
                    </div>
                    <div></div>
                    <div class="border">
                        <video width="200" height="200" id="preview" autoplay playsinline
                            style="margin: 0 auto; display:block;" class="border"></video>
                    </div>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                </div>
            </div>
        </div>
    </div>

</div>

{{!--
<script type="text/javascript" src="/javascripts/instascan.min.js"></script> --}}
<script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
<script>
    const singleAssetDetail = document.querySelector('#singleAssetDetail')
    const multipleAssetDetail = document.querySelector('#multipleAssetDetail')
    const singleAsset = document.querySelector('#singleAsset')
    const multipleAsset = document.querySelector('#multipleAsset')
    const modifyAsset = document.querySelector('#modifyAsset')
    const checkAsset = document.querySelector('#checkAsset')
    const scanqrcode_btn = document.querySelector('#scanqrcode_btn')
    const openCameraSwitch = document.querySelector('#openCameraSwitch')
    const assetArrivedMessage = document.querySelector('#assetArrivedMessage')
    const singleAssetGatepass = document.querySelector('#singleAssetGatepass')
    const confirmGP_btn = document.querySelector('#confirmGP_btn')
    const singleAssetGatepass_Modal2 = document.querySelector('#singleAssetGatepass_Modal2')
    // QRCODE
    var scanner = new Instascan.Scanner({ video: document.getElementById('preview'), scanPeriod: 5, mirror: false });
    const assetId = {{{ assetId }}}
    const gatepassStatus = {{{ gatepassStatus }}}
    const package = {{{ package }}}

    if (gatepassStatus === 1 && package === 1) {
        multipleAsset.disabled = true
        multipleAsset.innerHTML = 'gatepass 已到貨'
        multipleAsset.classList.remove('btn-outline-primary')
        multipleAsset.classList.add('btn-success')

        scanqrcode_btn.disabled = 'true'
        scanqrcode_btn.classList.remove('btn-outline-primary')
        scanqrcode_btn.classList.add('btn-success')
    } else if (assetId !== 0 && package === 0) {


        scanqrcode_btn.disabled = 'true'
        scanqrcode_btn.classList.remove('btn-outline-primary')
        scanqrcode_btn.classList.add('btn-danger')
        // 若資產不為移轉中, 則單個資產到貨按鈕 => 關閉, 單個資產移轉 => 開放
        console.log(assetId)
        axios.post('/api/qrcode/asset', { assetId })
            .then(reply => {
                console.log(reply)

                if (reply.data.response.status_id !== 3) {
                    singleAsset.disabled = 'true'
                    singleAsset.classList.remove('btn-outline-primary')
                    singleAsset.classList.add('btn-success')
                    singleAssetGatepass.disabled = ''
                } else {
                    // 檢查資產是否為移轉中, 若移轉中, 則單個資產到貨按鈕 => 開放, 單個資產移轉 => 關閉
                    singleAssetGatepass.disabled = 'true'
                    singleAssetGatepass.classList.remove('btn-outline-primary')
                    singleAssetGatepass.classList.add('btn-danger')

                }
            })
    }


    // 加入 gatepass 按鈕事件
    addGP_btn.addEventListener('click', () => {
        alert('這邊渲染 gatepass 下拉選單, 並添加鏡頭功能')
        console.log('axios 到後端請求 gp 所有資料, 在渲染到另外一個 Modal')

    })
    // 成立 Gatepass 按鈕事件
    confirmGP_btn.addEventListener('click', () => {
        let fromOffice = document.querySelector('#fromOffice')
        let toOffice = document.querySelector('#toOffice')
        console.log('成立 Gatepass')
        console.log(fromOffice.value)
        console.log(toOffice.value)
        fromOfficeId = fromOffice.value
        toOfficeId = toOffice.value
        if (fromOffice.value === toOffice.value) {
            alert('成立 Gatepass 失敗, 來源和目的地不可相同')
        } else {
            alert(`From : ${fromOffice.value}, To: ${toOffice.value}`)
            axios.post('/api/gatepass/empty', { fromOfficeId: fromOfficeId, toOfficeId: toOfficeId })
                .then(response => {
                    console.log(response)

                    if (response.status === 200) {
                        alert(response.data.message)
                        const returnSingleAssetGatepass = document.querySelector('#returnSingleAssetGatepass')
                        returnSingleAssetGatepass.click()
                    }
                })
                .catch(err => {
                    console.log(err)
                })
        }
    })
    // 單個資產移轉 按鈕事件
    singleAssetGatepass.addEventListener('click', () => {
        console.log('點擊單個資產移轉按鈕')
        let singleAssetGatepass_Modal_Body = document.querySelector('#singleAssetGatepass_Modal_Body')
        const createGP_btn = document.querySelector('#createGP_btn')
        const addGP_btn = document.querySelector('#addGP_btn')


        // 兩種情況
        // 1. 新建 Gatepass
        createGP_btn.addEventListener('click', () => {
            // singleAssetGatepass_Modal_Body.innerHTML =


            axios.post('/api/qrcode/office')
                .then(response => {
                    console.log(response)
                    if (response.status === 200) {
                        // 渲染 fromOffice & toOffice selection
                        let fromOffice = document.querySelector('#fromOffice')
                        let toOffice = document.querySelector('#toOffice')
                        let rawHtml = ''
                        response.data.response.forEach(data => {
                            rawHtml += `<option value="${data.id}">${data.name}</option>`
                        })
                        fromOffice.innerHTML += rawHtml
                        toOffice.innerHTML += rawHtml
                    }
                })
        })
        // 2. 選擇現有 Gatepass 加入
        // 請求現有 Gatepass 選單
    })
    singleAssetDetail.addEventListener('click', () => {
        console.log('請求單個資產詳情')
        axios.post('/api/qrcode/asset', { assetId })
            .then(reply => {

                let singleAssetDetail_Modal_table_body = document.querySelector('#singleAssetDetail-Modal-table-body')
                const assetImage = document.querySelector('#assetImage')
                const asset_id = document.querySelector('#asset_id')
                const asset_category = document.querySelector('#asset_category')
                const asset_name = document.querySelector('#asset_name')
                const asset_Vendor = document.querySelector('#asset_Vendor')
                const asset_Model = document.querySelector('#asset_Model')
                const asset_Quantity = document.querySelector('#asset_Quantity')
                const asset_Status = document.querySelector('#asset_Status')
                const asset_Office = document.querySelector('#asset_Office')
                const asset_Description = document.querySelector('#asset_Description')
                const data = reply.data.response
                console.log('===========================')
                console.log(data)
                console.log('===========================')
                assetImage.src = data.image
                asset_id.innerHTML = data.id
                asset_category.innerHTML = data.Category.name
                asset_name.innerHTML = data.name
                asset_Vendor.innerHTML = data.Vendor
                asset_Model.innerHTML = data.Model
                asset_Quantity.innerHTML = data.Quantity
                asset_Status.innerHTML = data.Status.name
                asset_Office.innerHTML = data.Office.name
                asset_Description.innerHTML = data.Description
            })
            .catch(err => {
                console.log(err)
            })
    })

    multipleAssetDetail.addEventListener('click', () => {
        console.log('請求多個資產詳情')
        const gatepassId = multipleAssetDetail.getAttribute('data-id')

        // 發送請求到後端查詢該筆 gatepass 的 Assets 資料, 回來渲染給 Modal 進行展示
        axios.post('/api/gatepass/package', { gatepassId })
            .then(reply => {
                console.log(reply.data.response)
                if (reply.data.status === 200) {
                    const multipleAssetDetail_Modal_body = document.querySelector('#multipleAssetDetail-Modal-body')
                    let rawHtml = `
                    <div class='row'>
                            <div class='col-xs-6 col-sm-6 col-md-3 col-3'>圖片</div>
                            <div class='col-xs-6 col-sm-6 col-md-3 col-3'>名稱</div>
                            <div class='col-xs-6 col-sm-6 col-md-3 col-3'>數量</div>
                            <div class='col-xs-6 col-sm-6 col-md-3 col-3'>當前狀態</div>
                    </div>
                    `
                    reply.data.response.forEach(asset => {

                        rawHtml += `
                        <div class='row mt-1'>
                            <div class='col-xs-6 col-sm-6 col-md-3 col-3'><img src='${asset.image}' style='width:80px;height:80px;'></div>
                            <div class='col-xs-6 col-sm-6 col-md-3 col-3'>${asset.name}</div>
                            <div class='col-xs-6 col-sm-6 col-md-3 col-3'>${asset.Quantity}</div>
                            <div class='col-xs-6 col-sm-6 col-md-3 col-3'>${asset.Status.name}</div>
                        </div>
                        `
                    })
                    multipleAssetDetail_Modal_body.innerHTML = rawHtml
                } else {
                    console.log('失敗請求...')
                }
            }).catch(err => {
                console.log(err)
            })
    })

    // 單個資產到貨按鈕 按鈕事件
    singleAsset.addEventListener('click', () => {
        console.log('單個資產到貨')
        axios.post('/api/qrcode/asset/received', { assetId })
            .then(response => {

                if (response.status === 200) {
                    alert(response.data.message)
                    // 關閉 單個資產到貨按鈕
                    singleAsset.disabled = 'true'
                    singleAsset.classList.remove('btn-outline-primary')
                    singleAsset.classList.add('btn-success')

                    // 開啟 單個資產移轉按鈕
                    singleAssetGatepass.disabled = ''
                    singleAssetGatepass.classList.remove('btn-danger')
                    singleAssetGatepass.classList.add('btn-outline-primary')
                }
            })
            .catch(err => {
                console.log(err)
            })
    })

    multipleAsset.addEventListener('click', () => {
        console.log('整包資產到貨')
        let conformAllAssetsStatus = confirm('確認當前所有資產到貨?')
        if (conformAllAssetsStatus) {
            console.log('準備到後端修改當前gatepass資產的狀態')
            const gatepassId = multipleAsset.getAttribute('data-id')
            axios.post('/api/gatepass/package/received', { gatepassId })
                .then(reply => {
                    console.log(reply.data.gatepassStatus)
                    if (reply.data.status === 200) {
                        alert('貨品已全部到貨, 狀態已修改, 關閉到貨按鈕')
                        multipleAsset.disabled = true
                        multipleAsset.innerHTML = 'gatepass 已到貨'
                        multipleAsset.classList.remove('btn-outline-primary')
                        multipleAsset.classList.add('btn-success')
                    } else {
                        console.log('失敗請求...')
                    }
                }).catch(err => {
                    console.log(err)
                })
        } else {
            console.log('返回當前頁')
        }
    })

    modifyAsset.addEventListener('click', () => {
        console.log('修改資產使用情況')
        const modifyAsset_Modal_body_form = document.querySelector('#modifyAsset-Modal-body-form')
        const modifyAssetImage = document.querySelector('#modifyAssetImage')
        Promise.all([axios.post('/api/qrcode/asset', { assetId }), axios.post('/api/qrcode/category'), axios.post('/api/qrcode/office'), axios.post('/api/qrcode/status')])
            .then(([asset, category, office, status]) => {
                console.log('===========================')
                console.log('Asset')
                console.log(asset)
                console.log('category')
                console.log(category)
                console.log('office')
                console.log(office)
                console.log('===========================')
                modifyAssetImage.src = asset.data.response.image
                let rawHtml = `
                <input type="hidden" name="assetId" value="${asset.data.response.id}">
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="inputState">類別</label>
                        <select id="inputState" class="form-control"  name='category_id'>
                `
                // 渲染 類別下拉式選單
                category.data.response.forEach(categories => {
                    if (categories.id === asset.data.response.Category.id) {
                        rawHtml += `
                        <option selected value='${categories.id}'>${categories.name}</option>
                        `
                    } else {
                        rawHtml += `
                        <option value='${categories.id}'>${categories.name}</option>
                        `
                    }
                })
                rawHtml += `
                        </select>
                    </div>
                    <div class="form-group col-md-6">
                      <label for="input_name">資產名稱</label>
                      <input type="text" class="form-control" id="input_name" value='${asset.data.response.name}' name='name'>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                      <label for="input_Vendor">廠牌</label>
                      <input type="text" class="form-control" id="input_Vendor" value='${asset.data.response.Vendor}' name='Vendor'>
                    </div>
                    <div class="form-group col-md-6">
                      <label for="input_Model">型號</label>
                      <input type="text" class="form-control" id="input_Model" value='${asset.data.response.Model}' name='Model'>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="inputState">狀態</label>
                        <select id="inputState" class="form-control"  name='status_id'>`

                // 渲染 狀態下拉式選單
                status.data.response.forEach(statuses => {
                    if (statuses.id === asset.data.response.Status.id) {
                        rawHtml += `
                        <option selected value='${statuses.id}'>${statuses.name}</option>
                        `
                    } else {
                        rawHtml += `
                        <option value='${statuses.id}'>${statuses.name}</option>
                        `
                    }
                })
                rawHtml += `
                        </select>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="inputState">位置</label>
                        <select id="inputState" class="form-control" name='office_id'>
                            `

                // 渲染 位置下拉式選單
                office.data.response.forEach(offices => {
                    if (offices.id === asset.data.response.Office.id) {
                        rawHtml += `
                        <option selected value='${offices.id}'>${offices.name}</option>
                        `
                    } else {
                        rawHtml += `
                        <option value='${offices.id}'>${offices.name}</option>
                        `
                    }
                })
                rawHtml += `
                        </select>
                    </div>
                </div>

                <div class="form-row">               
                    <div class="form-group col-md-12">
                      <label for="input_Model">描述</label>
                      <input type="text" class="form-control" id="input_Description" name='Description' value='${asset.data.response.Description}'>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                    <label for="input_image">圖片</label>
                    <input type="file" class="form-control-file" id="input_image" name='image'>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger">確認修改</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
                `
                modifyAsset_Modal_body_form.innerHTML = rawHtml
            })
            .catch(err => {
                console.log(err)
            })

    })

    checkAsset.addEventListener('click', () => {
        console.log('資產盤點')
    })

    // QR Code 掃描到貨 按鈕事件
    scanqrcode_btn.addEventListener('click', () => {
        console.log('QR Code 掃描到貨')
        // 默認開啟相機
        openCamera()
        scanner.addListener('scan', function (content) {
            console.log(content)
            // 分辨 QR code 類型
            let gatepassId = content.match(/gatepassId=\d+/)
            let assetId = content.match(/assetId=\d+/)

            if (gatepassId) {
                alert(gatepassId)
                console.log('辨別為 gatepass qrcode')
                gatepassId = gatepassId[0].replace(/gatepassId=/, '')
                axios.post('/api/qrcode/asset/received', { gatepassId })
                    .then(response => {
                        console.log(response)
                    })
                    .catch(err => {
                        console.log(err)
                    })
            } else if (assetId) {
                alert(`QR code : ${assetId}`)
                assetId = assetId[0].replace(/assetId=/, '')
                console.log('辨別為 asset qrcode : ' + assetId)
                axios.post('/api/qrcode/asset/received', { assetId })
                    .then(response => {
                        // 判斷已到貨, 不進行修改
                        if (response.status === 200) {
                            assetArrivedMessage.innerHTML = response.data.message
                        }
                    })
            } else {
                alert('請輸入公司格式的 qrcode')
            }
        })
    })

    openCameraSwitch.addEventListener('click', () => {
        const openCameraSwitchLabel = document.querySelector('#openCameraSwitchLabel')
        if (openCameraSwitch.checked === false) {
            closeCamera()
            openCameraSwitchLabel.innerHTML = '開啟相機'
        } else {
            openCamera()
            openCameraSwitchLabel.innerHTML = '關閉相機'
        }
    })



    // 開啟鏡頭 
    function openCamera() {
        console.log('呼叫 openCamera()')
        Instascan.Camera.getCameras().then(function (cameras) {

            console.log(cameras)
            console.log(cameras.length)

            if (cameras.length > 0) {
                if (cameras[1]) {
                    scanner.start(cameras[1]); // [0] 前鏡頭 [1] 後鏡頭 
                } else {
                    scanner.start(cameras[0]); // [0] 前鏡頭 [1] 後鏡頭 
                }

            } else {
                console.error('沒有找到相機');
                console.error('No cameras found.');
                alert('No cameras found.');
            }
        }).catch(function (e) {
            console.log('沒有找到鏡頭')
            console.error(e);
            alert(e);
        });
    }

    // 關閉鏡頭
    function closeCamera() {
        console.log('呼叫 closeCamera()')
        Instascan.Camera.getCameras().then(function (cameras) {
            if (cameras.length > 0) {
                if (cameras[1]) {
                    scanner.stop(cameras[1]); // [0] 前鏡頭 [1] 後鏡頭 
                } else {
                    scanner.stop(cameras[0]); // [0] 前鏡頭 [1] 後鏡頭 
                }
            }
        }).catch(function (e) {
            console.log('沒有找到鏡頭')
            console.error(e);
            alert(e);
        });
    }
</script>